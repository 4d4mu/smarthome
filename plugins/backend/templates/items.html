 <!DOCTYPE html>
{% extends "base.html" %}
{% import "navbar.html" as nav with context %}
{% block navbar %}
    {{ nav }}
{% endblock navbar %}
{% block content %}

 <div class="container">
     Item (gesamt: {{ smarthome.item_count }})
     <div id="tree"></div>
 </div>


 <script type="text/javascript" language="javascript">

function build_item_subtree_recursive(data) {
    var result = [];
    var tree_element = {};
    tree_element['text'] = data.path;
    var node_length = data.nodes.length;
    if (data.nodes.length > 0) {
        var child_nodes = [];
        for (var i = 0; i < node_length; i++) {
            var new_child_node = build_item_subtree_recursive(data.nodes[i]);
            child_nodes.push(new_child_node);
        }
        tree_element['nodes'] = child_nodes;
    }

    return tree_element;
}

function getTree() {
    var item_tree = [];

    $.getJSON('/items_json.html', function(result) {
        $.each(result, function(index, element) {
            item_tree.push(build_item_subtree_recursive(element));
        });
        $('#tree').treeview({data: item_tree});
    });
}
getTree();



function setVisibility(rowName) {
    // Tabellenzelle ermitteln

    var actualVisibility=document.getElementById(rowName).style.visibility;

    if(actualVisibility=='' || actualVisibility=='visible') {
        document.getElementById(rowName).style.visibility = "hidden";
        document.getElementById(rowName).style.display = "none";
        document.getElementById('span_'+rowName).innerHTML = "+";
    } else {
        document.getElementById(rowName).style.visibility = "visible";
        document.getElementById(rowName).style.display = "block";
        document.getElementById('span_'+rowName).innerHTML = "-";
    }
}
</script>
{% endblock %}
